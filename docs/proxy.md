# Proxy

Instead of sending a response to the client a response can be proxied to another server.

In the below example, requests to `/prx` on the butler server will initiate a request to the `https://swapi.info/api/films` and stream back the response from the swapi server back to the client. The body and
headers of the swapi server response will be copied to the butler server response. To the client the request
will look like it was generated by the butler server.

```go
package main

import butler "github.com/ncpa0cpl/butler"

func main() {
	server := f.CreateServer()
	server.Port = 8080

	proxyEndpoint := &f.BasicEndpoint[f.NoParams]{
		Method: "GET",
		Path:   "/prx",
		Handler: func(request *f.Request, params f.NoParams) *f.Response {
			return f.Respond.Proxy("https://swapi.info/api/films")
		},
	}

	server.Add(proxyEndpoint)
	server.Listen()
}
```

## ProxyRequestOptions

By default when performing a request to the proxied server, the same method, body and header will be used as the butler
server request. ProxyRequestOptions can be used to change each of those:

```go
package main

import butler "github.com/ncpa0cpl/butler"

func main() {
	server := f.CreateServer()
	server.Port = 8080

	proxyEndpoint := &f.BasicEndpoint[f.NoParams]{
		Method: "GET",
		Path:   "/prx",
		Handler: func(request *f.Request, params f.NoParams) *f.Response {
			newBody := []byte("Send this text instead")

			return f.Respond.Proxy("https://your.proxied/server", f.ProxyRequestOptions{
				Method:              "POST", // instead of GET
				Body:                &newBody, // or set to empty []byte to send empty body
				Headers:             map[string][]string{ "Authentication": {"Bearer XXX"} }, // add new headers
				DoNotForwardHeaders: true, // prevent copying over the headers from the current request
			})
		},
	}

	server.Add(proxyEndpoint)
	server.Listen()
}
```
