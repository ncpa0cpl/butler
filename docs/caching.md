# Http Caching

## HttpCachePolicy

HttpCachePolicy determines the contents of the `Cache-Control` header in the http responses, and how butler will handle the ETag and response skipping.

### Automatic ETag generation

Each non-streamed response will automatically have an etag generated. Etag is generated by hashing the response body using the fnv hashing algorithm.

Automatic ETag generation can be disabled by setting the `HttpCachePolicy.DisableETagGeneration` to true.

### Automatic Response Skipping

If the request contains a `If-None-Match` header, and the value of that header is the same as the response `ETag` header, butler will send a 304 (Not Modified) response with empty body instead of the response generated by the Handler.

Automatic Response Skipping can be disabled by setting the `HttpCachePolicy.DisableAutoResponseSkipping` to true.

### Cache Control

Cache control header is a http standard that determines how the clients, cdns and proxies can cache the server responses. HttpCachePolicy is what determines the butler default Cache-Control header value.

```go
package main

import butler "github.com/ncpa0cpl/http-butler"

func main() {
	app := butler.CreateServer()
	app.Port = 8080

	home := &butler.BasicEndpoint[butler.NoParams]{
		Method: "GET",
		Path: "/home",
		CachePolicy: &butler.HttpCachePolicy{
			Private: true,
			MaxAge: 24 * time.Hour,
			MustRevalidate: true,
		},
		Handler: func(request *butler.Request, params butler.NoParams) *butler.Response {
			return butler.Respond.Ok().Text("Welcome!")
		},
	}

	app.Add(home)
	app.Listen()
}
```
